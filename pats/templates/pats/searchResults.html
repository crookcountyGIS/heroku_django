{% extends 'pats/base.html' %}
{% load static %}
{% load humanize %}
{% load bootstrap5 %}
{% bootstrap_css %}
{% bootstrap_javascript %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js" integrity="sha512-pumBsjNRGGqkPzKHndZMaAG+bir374sORyzM3uulLV14lN5LyykqNk8eEeUlUkB3U0M4FApyaHraT65ihJhDpQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<link href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css" rel="stylesheet">
<script src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script>
<link rel="stylesheet" type="text/css" href="extensions/filter-control/bootstrap-table-filter-control.css">
<script src="extensions/filter-control/bootstrap-table-filter-control.js"></script>
{% block content %}
<nav class="navbar navbar-expand-lg nav-search">
  <div class="container-fluid ">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a id="searchAccount" class="nav-link nav-link-search" href="{% url 'index' %}">New Search     |</a>
        </li>
        <li class="nav-item">
          <a id="generalSearch" class="nav-link nav-link-search active" href="#">General Search</a>
        </li>
        <li class="nav-item">
          <a id="searchAccount" class="nav-link nav-link-search" href="#">Search Account</a>
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-search" href="#">Search Maptaxlot</a>
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-search" href="#">Search Owner</a>
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-search" href="#">Search Address</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
  <div class="container-fluid" style="padding-top:10px">
    <div class="row">
      <div style="max-width: 150px; float: left;font-size: small;">
        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" id="flexSwitchReal" checked>
          <label class="form-check-label" for="flexSwitchReal">Real</label>
        </div>
        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" id="flexSwitchPersonal" checked>
          <label class="form-check-label" for="flexSwitchPersonal">Personal</label>
        </div>
        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" id="flexSwitchMobile" checked>
          <label class="form-check-label" for="flexSwitchMobile">Mobile</label>
        </div>
      </div>
      <div class="col" >
        <div>
          Searching: <span style="color:rgb(138, 0, 0)">{search term}</span>
        </div>
        <div style="background-color: #F2F2F2; padding:5px;">
          <div class="row align-items-start pt-1">
            <div class="col-lg-4 col-sm-6">
              <input id="searchBar" class="form-control" type="text" placeholder="refine search  ***adjust as typed?" aria-label="default input example">
            </div>
          </div>
        </div>
        <div>
          <table id="table" data-toggle="table" class="table table-borderless table-striped table-hover" style="font-size: .75em; font-family: Arial, Helvetica, sans-serif;">
            <thead>
              <tr class="table-dark">
                <th data-sortable="true">Map / Taxlot</th>
                <th data-sortable="true">Account</th>
                <th data-sortable="true">Owner Name</th>
                <th data-sortable="true">Property Addess (Situs)</th>
                <th data-sortable="true">Subdivision</th>
                <th data-sortable="true">Property Type</th>
              </tr>
            </thead>
            <tbody>
              {% if d %}
              {% for i in d %}
              <tr>
                <td>{{i.map_taxlot}}</td>
                <td id="accountCol">{{i.account_id}}</td>
                <td>{{i.owner_name}}</td>
                <td>{{i.situs_address}}</td>
                <td id="subdivision">{{i.subdivision}}</td>
                <td id="accountType">{{i.account_type}}</td>
              </tr>
              {% endfor %}
              {% endif %}
            </tbody>
          </table>
        </div>
  
      </div>
    </div>
  </div>


  <script type="text/javascript">

    var btn = document.getElementById("searchBtn");
    var searchBar = document.getElementById("searchBar");
    var realSwitch = document.getElementById("flexSwitchReal");
    var personalSwitch = document.getElementById("flexSwitchPersonal");
    var mobileSwitch = document.getElementById("flexSwitchMobile");
    var $table = $('#table')
    var $column = $('#accountType')


    $('#table tbody').on('click', 'tr', function(e) {

    let columns = $(this).find('td').map(function() {
        return $(this).text();
        }).get();
    
    const accountQuery = parseInt(columns[1]);
   
    window.location.href = "{% url 'account_query' 0 %}".replace(/0/, accountQuery)
 
});

    btn.addEventListener("click", function() {
        var name = searchBar.value;
        if (name != '') {
          window.location.assign("{% url 'tableSearchResults' 0 %}".replace(/0/, name))
    }

    });

    searchBar.addEventListener("keypress", function(e) {
        if (e.key === 'Enter' && name != '') {
            var name = searchBar.value;
            window.location.assign("{% url 'tableSearchResults' 0 %}".replace(/0/, name))
        }
    });

    realSwitch.addEventListener("change", function(e) {
      var isChecked = e.target.checked;
      console.log(isChecked);
      //var table = $table.bootstrapTable('getOptions').data;
      //console.log(table);

    });
    //   var filterAlgorithm = $('[propertyType="filterAlgorithm"]').val()
     
     
     
     
     
    //   //var filter = 'Real'
    //   //var filterText = this.value.toLowerCase();
      
    // // if (e.target.checked == 'true') {

    // //   var filterText = 'Real';
    // //   $('#resultsTable #accountType').each(function() {
    // //       var $this = $(this);
    // //       console.log($this);
    // //       var text = $this.find('td').text().toLowerCase();
    // //       console.log(text);
    // //         if (text.indexOf(filterText) > -1) {
    // //             $this.show();
    // //         } else {
    // //           $this.hide();
    // //         }        
    // //     });

    // //   }

    // }); 
    
    personalSwitch.addEventListener("change", function(e) {
      console.log(e.target.checked);
    });
    
    mobileSwitch.addEventListener("change", function(e) {
      console.log(e.target.checked);
    }); 


  </script>

{% endblock %}